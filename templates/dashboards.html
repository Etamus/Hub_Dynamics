<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hub Spare Parts - Dashboards</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="/static/css/hub.css">
    <link rel="stylesheet" href="/static/css/shared.css">
    <link rel="stylesheet" href="/static/css/dashboards.css">
</head>
<body>
    <script>
      // (Script de carregamento de tema mantido)
      (function() {
        try {
          const savedTheme = localStorage.getItem('hubTheme') || 'light';
          if (savedTheme === 'dark') {
            document.body.classList.add('theme-dark');
          } else if (savedTheme === 'light') {
            // Nenhuma classe necessária
          } else {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
              document.body.classList.add('theme-dark');
            }
          }
        } catch (e) {
          // Ignora erros
        }
      })();
    </script>

    <button id="theme-toggle-btn" class="theme-toggle-button" aria-label="Alternar Tema" title="Alternar Tema">
        <i class="fas fa-sun"></i> 
    </button>
    <button id="fullscreen-btn" class="fullscreen-button" title="Tela Cheia"><i class="fas fa-expand"></i></button>
    <a href="/" id="back-btn" class="back-button" title="Voltar ao Hub"><i class="fas fa-arrow-left"></i></a>
    
    <div id="selection-screen">
        <div style="text-align: center;">
            <h1 class="main-title">Dashboards</h1>
            <p class="subtitle"><i class="fas fa-info-circle"></i> <span>Selecione a plataforma para visualizar o relatório</span></p>
        </div>
        
        <div class="system-selector">
            {% for system_key, system_data in dashboards_data.items() %}
                <label>
                    <input type="radio" name="dashboard_system" value="{{ system_key }}" {{ 'checked' if loop.first }}>
                    <img src="{{ system_data.icon }}" alt="Logo {{ system_data.system_name }}">
                </label>
            {% endfor %}
        </div>
        
        
        {% for system_key, system_data in dashboards_data.items() %}
        
            <div id="{{ system_key }}-options" class="dashboard-options hidden">
                
                <div id="{{ system_key }}-area-selection" class="dashboard-options area-selection-container">
                    {% for area_key, area_data in system_data.areas.items() %}
                        <button class="area-button" data-area="{{ area_key }}">{{ area_data.name }}</button>
                    {% endfor %}
                </div>
                
                {% if system_key == 'looker' %}
                <div id="looker-pagination" class="pagination-controls">
                    <button id="looker-prev-page" class="page-button" title="Anterior">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <span id="looker-page-info" class="page-info">Página 1 de X</span>
                    <button id="looker-next-page" class="page-button" title="Próxima">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                {% endif %}
                
                {% for area_key, area_data in system_data.areas.items() %}
                    <div id="dashboards-{{ area_key }}" class="dashboard-options hidden">
                        
                        {% for item in area_data['items'] %}
                            <button class="view-button"
                                data-id="{{ item.id }}"
                                data-url="{{ item.url }}"
                                {% if item.width %}data-width="{{ item.width }}"{% endif %}
                                data-preview-gif="{{ item.gif }}"
                                data-preview-text="{{ item.text }}"
                                data-preview-tags="{{ item.tags }}">
                                {{ item.name }}
                            </button>
                        {% endfor %}
                        
                        <button class="back-to-areas-button" title="Voltar para Áreas"><i class="fas fa-arrow-left"></i></button>
                    </div>
                {% endfor %}
                
            </div>
        
        {% endfor %}
        
    </div>

    <div id="login-modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <button id="login-modal-close-btn" class="modal-close" title="Fechar">&times;</button>
            
            <img id="modal-logo-tableau" src="/static/icones/tableau_logo.png" alt="Logo Tableau" class="modal-logo">
            
            <p id="modal-subtitle">Insira suas credenciais para logar.</p>
            <div class="modal-form">
                <div class="modal-input-group">
                    <label for="modal-user">Usuário:</label>
                    <input type="text" id="modal-user">
                </div>
                <div class="modal-input-group">
                    <label for="modal-pass">Senha:</label>
                    <input type="password" id="modal-pass">
                </div>
                <button id="modal-execute-btn" class="button btn-execute">Logar</button>
                
                {% if is_hub_logged_in %}
                <button id="modal-save-conn-btn" class="button btn-save-conn">Adicionar Conexão</button>
                {% endif %}
            </div>
        </div>
    </div>

    <div id="dashboard-view" class="dashboard-container"></div>
    
    <div id="preview-panel">
        <img id="preview-image" src="" alt="Preview do Dashboard">
        <p id="preview-description"></p>
        <div id="preview-tags-container"></div>
    </div>

    <script src="/static/js/dashboards.js" defer></script>
    <script src="/static/js/shared.js" defer></script>
</body>
</html>